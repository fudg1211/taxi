(function(p,w){window.touchSlider=function(c){function K(a){E.removeClass(c.currentClass).eq(a).addClass(c.currentClass)}function H(a,b){var c=x.current;c!==a&&(a=a!==w?a:c+1,n.to(a,{complete:b}))}function F(a){n.to(x.current+1,{dirX:1,complete:a})}function I(a){n.to(x.current-1,{dirX:-1,complete:a})}function y(){z=!0;A||(clearTimeout(s),s=setTimeout(function(){!n.moving&&!A&&F()},c.delay));return c.container}function L(){var a=p(document),b,c,o=!1,k,h,g,e,l,d,i,j,f,r=function(b){if(b.originalEvent.touches.length===
1)g=e=b.pageX=b.originalEvent.touches[0].pageX,i=b.pageY=b.originalEvent.touches[0].pageY,d=f=0,new WebKitCSSMatrix(window.getComputedStyle(m[0]).webkitTransform),h=[0,0,0,g],a.bind(B,q),a.one(C,s),n.moveStart(b)},q=function(a){var b,o;if(a.originalEvent.touches&&v){if(a.originalEvent.touches.length!==1)return;b=a.pageX=a.originalEvent.touches[0].pageX;o=a.pageY=a.originalEvent.touches[0].pageY;d+=Math.abs(b-e);f+=Math.abs(o-i);if(Math.abs(d-f)>50){var g=d;d=Math.min(100,Math.max(0,d-f));f=Math.min(100,
Math.max(0,f-g))}if(b===e)return;c||(d>f?(a.preventDefault(),c=!0):s(a))}else{b=a.pageX;o=a.pageY;if(b===e)return;p.browser.msie&&a.preventDefault()}l+=Math.abs(b-e);j+=Math.abs(o-i);k.shift();k.push(a.timeStamp);h.shift();h.push(b);n.move(a,e);e=b;i=o},s=function(d){o=!1;if(!d.originalEvent||d.originalEvent.touches)d.pageX=e,d.pageY=i;a.unbind(B,q);for(var c=k.length,f=0,g=0;--c>0;)if(k[c-1]){var m=h[c]-h[c-1];f+=Math.abs(m)/(k[c]-k[c-1]);m!==0&&(g=m>0?-1:1)}f/=k.length;n.moveEnd(d,f,g,b,l,j);D=
!1;if(l+j>4)t.one("click",function(a){a.preventDefault()})};t.bind(G,function(d){if(!(d.which>1))if(o&&a.triggerHandler(C+"."+u),o=!0,c=!1,b=d.timeStamp,l=j=0,k=[0,0,0,b],d.originalEvent.touches)a.one(G,r);else d.preventDefault(),g=e=d.pageX,i=d.pageY,h=[0,0,0,g],a.bind(B,q),a.one(C+"."+u,s),n.moveStart(d)})}var c=c||{},u=c.namespace||"touchslider",q=p(c.container);if(q.length!==1)q.each(function(){touchSlider({container:this})});else{var c=p.extend({autoplay:!1,delay:3E3,margin:5,viewport:"."+u+
"-viewport",prev:"."+u+"-prev",next:"."+u+"-next",pagination:"."+u+"-nav-item",currentClass:u+"-nav-item-current",duration:350,mouseTouch:!0},c),x={current:0,step:H,next:F,prev:I,start:y,stop:function(){clearTimeout(s);z=!1;return c.container}},v="ontouchstart"in window&&"WebKitCSSMatrix"in window,G="touchstart",B="touchmove",C="touchend",t=p(c.viewport,q),m=c.scroller?p(c.scroller,q):t.children(),f=m.children(),E=p(c.pagination,q);if(m.css("position")!=="absolute"){var J=t.height();t.css({height:J,
position:"relative"});m.css({position:"absolute",left:0,height:J,width:1E5})}v||(G="mousedown",B="mousemove",C="mouseup");f.css("position","absolute");var r=v?function(a,b,c){if(b===w)return(new WebKitCSSMatrix(getComputedStyle(a.jquery?a[0]:a).webkitTransform)).e;a.css({webkitTransitionDuration:c?c+"ms":"0",webkitTransform:function(a){return"translate3d("+(typeof b==="number"?b:b.call(this,a))+"px,0,0)"}})}:function(a,b){if(b===w)return parseInt((a.jquery?a[0]:a).style.left,10);a.css("left",b)};
v&&f.css({webkitTransitionProperty:"-webkit-transform",webkitTransitionTimingFunction:"cubic-bezier(0,0,0.25,1)"});r(f.not(f[0]),1E4);r(f.eq(0),0);var n=function(){var a=[0],b=[0],q=p.noop;return{moving:!1,init:function(){m.bind("webkitTransitionEnd",function(){q()})},to:function(o,k){k=k||{};o>=f.length?o=0:o<0&&(o=f.length-1);var h=c.duration,g=f.eq(o),e=p.inArray(o,a),l=0;m.stop();n.moving=!0;clearTimeout(s);if(e!==-1)l=b[e];else{var d,i=f.index(g),e=w;if(k.dirX===-1)b.unshift(0),a.unshift(i);
else if(k.dirX===1)b.push(0),a.push(i);else{for(d=a.length-1;d>=0;d--)if(a[d]<i){b.splice(d+1,0,0);a.splice(d+1,0,i);e=0;break}e===w&&(b.unshift(b),a.unshift(i))}e=p.inArray(i,a);if(e===0)l=b[1]-(g.outerWidth()+c.margin),r(g,l),b[e]=l;else if(e===a.length-1)l=b[e-1]+f.eq(a[e-1]).outerWidth()+c.margin,r(g,l),b[e]=l;else{d=g.outerWidth();g.css("opacity",0);l=b[e+1]-Math.round((d+c.margin)/2);b[e]=l;r(g,l);var j=l,i=a.length;for(d=e-1;d>=0;d--)j-=f.eq(a[d]).outerWidth()+c.margin,b[d]=j;j=l;for(d=e+1;d<
i;d++)j+=f.eq(a[d]).outerWidth()+c.margin,b[d]=j;for(d=0;d<i;d++)f.eq(a[d]).animate({left:b[d]},{duration:h,queue:!1,complete:function(){g.is(this)&&g.animate({opacity:1},h)}})}}k.pxInMs&&(h=Math.min(Math.max(Math.round(Math.abs(r(m))/k.pxInMs),100),h));q=function(){r(f.not(g),-1E4);a=[f.index(g)];b=[l];k.complete&&k.complete();n.moving=!1;z&&y()};v?r(m,-l,h):m.animate({left:-l},{duration:h,queue:!1,complete:q});x.current=o;K(o)},stop:function(){v?r(m,r(m)):m.stop()},moveStart:function(c){n.moving=
!0;clearTimeout(s);m.stop();n.startPageX=c.pageX;var c=r(m),k;n.leftCount=c;if(a[0]===0){if(b[0]+c>0)n.leftCount=c+(b[0]+c)*3}else if(a[a.length-1]===f.length-1&&(k=b[a.length-1]+c,k<0))n.leftCount=c+k*3},move:function(o,k){var h=o.pageX-k,g=r(m);f.eq(a[0]);var e=a.length-1,l=f.eq(a[e]),d,i;n.leftCount+=h;if(h>0)for(;a[0]!==0&&g+b[0]+h>c.margin;)d=f.eq(a[0]-1),i=b[0]-d.outerWidth()-c.margin,r(d,i),b.unshift(i),a.unshift(a[0]-1),e++;if((h>0&&g+b[0]+h>0||h<0&&g+b[0]>0)&&a[0]===0)h=Math.min(Math.round((n.leftCount+
b[0])/4),t.innerWidth()/2),h-=g+b[0];if(h<0)for(;!l.is(f.last())&&g+b[e]+h+l.outerWidth()+c.margin<t.innerWidth();)d=f.eq(a[e]+1),i=b[e]+l.outerWidth()+c.margin,r(d,i),b.push(i),a.push(a[e++]+1),l=d;if((h>0&&g+b[e]<0||h<0&&g+b[e]+h<0)&&l.is(f.last()))h=Math.max(Math.round((n.leftCount+b[e])/4),-t.innerWidth()/2),h-=g+b[e];r(m,g+h)},moveEnd:function(c,k,h,g,e,l){var d=a.length,i=r(m),j=d-1,q;if(b[0]+i>0)j=0;else if(!(b[a.length-1]+i<0)){q={pxInMs:k};for(var p,k=d-1,s=t.innerWidth(),j=0;j<d-1;j++)if(p=
b[j]+f.eq(a[j]).outerWidth()+i,p>0&&p>s-(b[j+1]+i)){k=j;break}if(D)j=k;else{i=d-1;p=Math.round(m.offset().left);for(j=0;j<d;j++)if(b[j]+p>c.pageX){i=j-1;break}j=k;k===i&&c.timeStamp-g<1E3&&e+l>Math.sqrt(Math.pow(t.height(),2)+Math.pow(s,2))*0.05&&(j=Math.max(0,Math.min(d-1,j+h)))}}j=a[j];n.to(j,q)}}}();n.init();if(v){var D=!1;m.bind("webkitTransitionStart",function(){D=!0});m.bind("webkitTransitionEnd",function(){D=!1})}var A=!1,z=!1,s;t.hover(function(){clearTimeout(s);A=!0},function(){A=!1;z&&y()});
E.click(function(){H(E.index(this))});p(c.prev,q).click(function(){I()});p(c.next,q).click(function(){F()});c.mouseTouch&&L();c.autoplay&&y();q.data(u,x)}};p.fn.touchSlider=function(c){c=c||{};c.container=this;touchSlider(c);return this}})(jQuery);
